<form [formGroup]="songUploadForm" (ngSubmit)="upload()">
  <div class="form-group">
    <label for="songName">Song Name</label>
    <input type="text" class="form-control" id="songName" placeholder="Enter song name" formControlName="name">
    <div class="alert alert-danger" role="alert" *ngIf="songUploadForm.get('name').hasError('required') && songUploadForm.get('name').touched">
      Must be filled!
    </div>
  </div>

<!--  <div class="form-group">-->
<!--    <label for="artistName">Artist Name</label>-->
<!--    <input type="text" class="form-control" id="artistName" placeholder="Multiple artists separated by commas" formControlName="artists">-->
<!--    <div class="alert alert-danger" role="alert" *ngIf="songUploadForm.get('artists').hasError('required') && songUploadForm.get('artists').touched">-->
<!--      Must be filled!-->
<!--    </div>-->
<!--  </div>-->

  <div formArrayName="artists" class="form-group"
       *ngFor="let artist of artists.controls; let i = index;">
    <div [formGroupName]="i">
      <mat-form-field>
        <label for="artistName">{{ 'Artist ' + (i + 1) + ' name' }}
          <input (focus)="suggestArtist(i)" matInput [matAutocomplete]="auto" id="artistName" class="form-control" type="text" [formControl]="artists.controls[i]" [placeholder]="'Artist ' + (i + 1) + ' name'">
        </label>
        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
          <mat-option *ngIf="isLoading" class="is-loading"><mat-spinner diameter="50"></mat-spinner></mat-option>
          <ng-container *ngIf="!isLoading">
            <mat-option *ngFor="let artist of filteredArtists" [value]="artist">
              <span>{{ artist.name }}</span>
              <small> | ID: {{artist.id}}</small>
            </mat-option>
          </ng-container>
        </mat-autocomplete>
      </mat-form-field>
      <button type="button" class="btn btn-info" (click)="addArtist()">+</button>
      <button type="button" class="btn btn-danger" (click)="removeArtist(i)" *ngIf="artists.controls.length > 1">-</button>
    </div>

<!--    Chosen name: {{ artists.controls[i]..name.value }}-->
  </div>

  <div class="form-group">
    <label for="releaseDate">Release Date</label>
    <input type="date" class="form-control" id="releaseDate" placeholder="yyyy-mm-dd" formControlName="releaseDate">
    <div class="alert alert-danger" role="alert" *ngIf="songUploadForm.get('releaseDate').hasError('required') && songUploadForm.get('releaseDate').touched">
      Must be filled!
    </div>
  </div>

  <label for="audio">Audio File</label>
  <div class="form-group custom-file">

    <label class="custom-file-label" *ngIf=!isAudioFileChosen>Choose file</label>
    <label class="custom-file-label" *ngIf=isAudioFileChosen>{{ audioFileName }}</label>
    <input type="file" class="custom-file-input" id="audio" (change)="selectFile($event)">
  </div>
  <div class="mt-sm-3">
    <button type="submit" class="btn btn-primary">Submit</button>
  </div>
  <span *ngIf="message">{{ message }}</span>
  <!-- Progress Bar -->
  <div class="progress form-group" *ngIf="progress.value > 0">
    <div class="progress-bar progress-bar-striped bg-success" role="progressbar" [style.width.%]="progress">
    </div>
  </div>
</form>
<!--<ngb-pagination>-->
<!--  <ng-template ngbPaginationFirst>First</ng-template>-->
<!--  <ng-template ngbPaginationLast>Last</ng-template>-->
<!--  <ng-template ngbPaginationPrevious>Prev</ng-template>-->
<!--  <ng-template ngbPaginationNext>Next</ng-template>-->
<!--  <ng-template ngbPaginationEllipsis>...</ng-template>-->
<!--  <ng-template ngbPaginationNumber let-page>{{ page }}</ng-template>-->
<!--</ngb-pagination>-->
