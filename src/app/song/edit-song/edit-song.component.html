<form [formGroup]="songUpdateForm" (ngSubmit)="onSubmit()">
  <div class="form-group">
    <label for="songName">Song Name</label>
    <input type="text" class="form-control" id="songName" placeholder="Enter song name" formControlName="name">
    <div class="alert alert-danger" role="alert"
         *ngIf="songUpdateForm.get('name').hasError('required') && songUpdateForm.get('name').touched">
      Must be filled!
    </div>
  </div>


  <div formArrayName="artists" class="form-group"
       *ngFor="let artist of artists.controls; let i = index;">
    <div [formGroupName]="i">
      <mat-form-field>
        <label for="artistName">{{ 'Artist ' + (i + 1) + ' name' }}
          <input matInput [matAutocomplete]="auto" id="artistName" class="form-control" type="text"
                 [formControl]="artists.controls[i]" [placeholder]="'Artist ' + (i + 1) + ' name'">
        </label>
        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
          <mat-option *ngIf="isLoading" class="is-loading">
            <mat-spinner diameter="25"></mat-spinner>
          </mat-option>
          <ng-container *ngIf="!isLoading">
            <mat-option *ngFor="let artist of filteredArtists" [value]="artist">
              <span>{{ artist.name }}</span>
              <small> | ID: {{artist.id}}</small>
            </mat-option>
          </ng-container>
        </mat-autocomplete>
      </mat-form-field>

      <button type="button" class="btn btn-info" (click)="addArtist()">+</button>
      <button type="button" class="btn btn-danger" (click)="removeArtist(i)" *ngIf="artists.controls.length > 1">-
      </button>
    </div>

  </div>

  <div class="form-group">
    <label for="releaseDate">Release Date</label>
    <input type="date" class="form-control" id="releaseDate" placeholder="yyyy-mm-dd" formControlName="releaseDate">
    <div class="alert alert-danger" role="alert"
         *ngIf="songUpdateForm.get('releaseDate').hasError('required') && songUpdateForm.get('releaseDate').touched">
      Must be filled!
    </div>
  </div>


  <button type="submit" class="btn btn-primary">Submit</button>

  <span *ngIf="message">{{ message }}</span>

</form>
